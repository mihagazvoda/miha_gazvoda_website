---
title: "Bayesian AB Testing"
description: |
  A short description of the post.
author:
  - name: Miha Gazvoda
    url: https://mihagazvoda.com
date: 04-17-2021
categories: 
  - R
  - data science
  - Bayesian
output:
  distill::distill_article:
    self_contained: false
---


In this post I will introduce you to Bayesian A/B testing for Binomial data (proportions of clicks on an ad or heads when throwing a coin). We will start with the  

# Introduction

In one of my previous posts I talked about [Intuitive Bayesian Inference](https://mihagazvoda.com/posts/2020-11-24-bayesian-updating/) for Bernoulli trials. The focus was about building intuition on Bayesian inference. Here we will take a look on how to use Beta function to make the Bayesian inference for Binomial data smoother. 
In this example, let's say we want to figure out who's better basketball 3-point shooter. Again, we will have data that it will look like: 

```{r}
made_3_point <- c(FALSE, FALSE, FALSE)
```

The skill is not changing over time. We want to figure out what is my true shot precision.

We will use Bayesian rule to figure out this: 

$$ 
P(p|data) = \frac{P(data|p)P(p)}{P(data)}
$$
where $P(p|data)$ is the (updated) posterior distribution of my skill $p$ given likelihood $P(data|p)$ and prior assumptions `P(p)` and `P(data)` about my skill and data.

$$
posterior \propto likelihood \times prior
$$

# Beta function, the alpha (wo)man of Binomial Bayesian model

> [Wikipedia](https://en.wikipedia.org/wiki/Beta_distribution) says that the beta distribution is a family of continuous probability distributions defined on the interval [0, 1] parameterized by two positive shape parameters, denoted by $\alpha$ and $\beta$. 

That's great since our `p` (probability of hitting a 3-pointer) is also on this range. It gets even better - beta is [conjugate](https://en.wikipedia.org/wiki/Conjugate_prior) distribution for Binomial likelihood. This means that the posterior PDF is from the same probability distribution family as prior PDF. Both are beta functions! We need just update the parameters $\alpha$ and $\beta$ based on observed data to come from prior to posterior. But how?

Parameters present number of successes ($\alpha$) and failures ($\beta$).

```{r}
tidyr::crossing(
  alpha = 1:3, 
  beta = 1:3, 
  x = seq(0, 1, length.out = 100)
) %>% 
  mutate(
    y = dbeta(x, alpha, beta),
    parameter = paste(alpha, beta)
  ) %>% 
  ggplot(aes(x, y, color = parameter)) + 
  geom_line()
```


* mogoce plotej razlicne bete








# Plan: 

* how it relates to my previous post
* introduction to conjugate priors
* more about beta

* a simple example with beta

```{r}
source("functions.R")
prop_model(c(TRUE, FALSE, TRUE))
```

* why would you prefer bayesian over standard testing

> First of all, interpretability is everything. Would you rather say "P(A > B) is 10%", or "Assuming the null hypothesis that A and B are equal is true, the probability that we would see a result this extreme in A vs B is equal to 3%"?`

* repeated testing?

* compare standard vs bayesian CI




* some tool to play around with betas

* play around with priors

 w

# Introduction


# Resources
Blogs: 

* https://www.countbayesie.com/blog/2015/4/25/bayesian-ab-testing
* http://fportman.com/writing/bayesab-a-new-r-package-for-bayesian-ab-testing/
* http://varianceexplained.org/r/bayesian-ab-testing/
* beautiful viz: http://www.sumsar.net/blog/2018/12/visualizing-the-beta-binomial/




